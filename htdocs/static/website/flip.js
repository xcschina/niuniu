(function(e,t,n,r){function i(e){return u.transform3d?"translate3d("+e+"px, 0, 0)":"translate("+e+"px, 0)"}function s(e,t){return u.touch?e.changedTouches[0][t]:e[t]}var n=!1,o=/horizon/.test(function(){horizon})?/\b_super\b/:/.*/;this.Class=function(){},Class.extend=function(e){function t(){!n&&this.init&&this.init.apply(this,arguments)}var r=this.prototype;n=!0;var i=new this;n=!1;for(var s in e)i[s]=typeof e[s]=="function"&&typeof r[s]=="function"&&o.test(e[s])?function(e,t){return function(){var n=this._super;this._super=r[e];var i=t.apply(this,arguments);return this._super=n,i}}(s,e[s]):e[s];return t.prototype=i,t.constructor=t,t.extend=arguments.callee,t};var u={transform3d:"WebKitCSSMatrix"in e,touch:"ontouchstart"in e},a={start:u.touch?"touchstart":"mousedown",move:u.touch?"touchmove":"mousemove",end:u.touch?"touchend":"mouseup"},f=Class.extend({init:function(e,t,n,r){var s=this;return e.nodeType&&e.nodeType==1?(s.element=e,n&&(s.tab=s.tab)):typeof e=="string"&&(s.element=document.getElementById(e)||document.querySelector(e),n&&(s.tab=document.getElementById(n)||document.querySelector(n))),s.element.style.display="-webkit-box",s.element.style.webkitTransitionProperty="-webkit-transform",s.element.style.webkitTransitionTimingFunction="cubic-bezier(0,0,0.25,1)",s.element.style.webkitTransitionDuration="0",s.element.style.webkitTransform=i(0),s.conf=t||{},s.touchEnabled=!0,s.currentPoint=0,s.currentX=0,s.refresh(),s.element.addEventListener(a.start,s,!1),s.element.addEventListener(a.move,s,!1),document.addEventListener(a.end,s,!1),s},handleEvent:function(e){var t=this;switch(e.type){case a.start:t._touchStart(e);break;case a.move:t._touchMove(e);break;case a.end:t._touchEnd(e);break;case"click":t._click(e)}},refresh:function(e){var t=this,n=e||t.conf;t.currentPoint=n.currentPoint||(n.currentPoint==0?0:t.currentPoint),n.point>0?t.maxPoint=n.point-1:t.maxPoint=function(){var e=t.element.childNodes,n=0,r=0,i=e.length,s;for(;r<i;r++)s=e[r],s.nodeType===1&&n++;return n>0&&n--,n}(),t.distance=n.distance||t.element.scrollWidth/(t.maxPoint+1),t.maxX=n.maxX?-n.maxX:-t.distance*t.maxPoint,t.moveToPoint(t.currentPoint)},hasNext:function(){var e=this;return e.currentPoint<e.maxPoint},hasPrev:function(){var e=this;return e.currentPoint>0},toNext:function(){var e=this;if(!e.hasNext())return;e.moveToPoint(e.currentPoint+1)},toPrev:function(){var e=this;if(!e.hasPrev())return;e.moveToPoint(e.currentPoint-1)},moveToPoint:function(e){var t=this,n=t.tab?t.tab.childNodes:null;t.currentPoint=e<0?0:e>t.maxPoint?t.maxPoint:parseInt(e),t.element.style.webkitTransitionDuration="500ms",t._setX(-t.currentPoint*t.distance);var r=document.createEvent("Event");r.initEvent("css3flip.moveend",!0,!1),t.element.dispatchEvent(r),t.ftab&&(t.ftab.className=""),n&&(t.ftab&&(t.ftab.className=""),t.ftab=n[t.currentPoint],t.ftab.className="focus")},_setX:function(e){var t=this;t.currentX=e,t.element.style.webkitTransform=i(e)},_touchStart:function(e){var t=this;if(!t.touchEnabled)return;u.touch||e.preventDefault(),t.element.style.webkitTransitionDuration="0",t.scrolling=!0,t.moveReady=!1,t.startPageX=s(e,"pageX"),t.startPageY=s(e,"pageY"),t.basePageX=t.startPageX,t.directionX=0,t.startTime=e.timeStamp},_touchMove:function(e){var t=this;if(!t.scrolling)return;r&&clearTimeout(r.timer);var n=s(e,"pageX"),i=s(e,"pageY"),o,u,a,f;if(t.moveReady){e.preventDefault(),e.stopPropagation(),o=n-t.basePageX,u=t.currentX+o;if(u>=0||u<t.maxX)u=Math.round(t.currentX+o/3);t._setX(u),t.directionX=o>0?-1:1}else a=Math.abs(n-t.startPageX),f=Math.abs(i-t.startPageY),a>5?(e.preventDefault(),e.stopPropagation(),t.moveReady=!0,t.element.addEventListener("click",t,!0)):f>5&&(t.scrolling=!1);t.basePageX=n},_touchEnd:function(e){var t=this;if(!t.scrolling)return;r&&r.fun(),t.scrolling=!1;var n=-t.currentX/t.distance;n=t.directionX>0?Math.ceil(n):t.directionX<0?Math.floor(n):Math.round(n),t.moveToPoint(n),setTimeout(function(){t.element.removeEventListener("click",t,!0)},200)},_click:function(e){var t=this;e.stopPropagation(),e.preventDefault()},destroy:function(){var e=this;e.element.removeEventListener(touchStartEvent,e),e.element.removeEventListener(touchMoveEvent,e),document.removeEventListener(touchEndEvent,e)}});this.Css3Flip=function(e,t,n,r){return this instanceof f?this.init(e,t,n,r):new f(e,t,n,r)}})(window)